<!doctype html>
<html lang="id">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Test Three.js Only</title>
        <style>
            body {
                margin: 0;
                background: #000;
                color: #0f0;
                font-family: 'Courier New', monospace;
                padding: 20px;
            }

            #container {
                width: 100%;
                height: 400px;
                border: 2px solid #0f0;
                margin: 20px 0;
            }

            .log {
                padding: 5px;
                margin: 5px 0;
                background: rgba(0, 255, 0, 0.1);
                border-left: 3px solid #0f0;
            }

            .error {
                color: #f00;
                border-left-color: #f00;
                background: rgba(255, 0, 0, 0.1);
            }
        </style>
    </head>
    <body>
        <h1>ğŸ§ª Test Three.js Only (Tanpa Framework)</h1>
        <p>Test ini hanya memuat Three.js dan membuat scene sederhana.</p>
        <p>
            Jika ini berhasil, berarti masalahnya ada di framework. Jika gagal, berarti masalah di
            Three.js atau setup.
        </p>

        <div id="container"></div>

        <h2>ğŸ“‹ Log:</h2>
        <div id="log"></div>

        <script type="module">
            const logEl = document.getElementById('log');

            function log(message, isError = false) {
                const div = document.createElement('div');
                div.className = isError ? 'log error' : 'log';
                div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
                logEl.appendChild(div);
                console.log(message);
            }

            async function test() {
                try {
                    log('ğŸ”§ Step 1: Checking protocol...');
                    if (window.location.protocol === 'file:') {
                        log('âŒ ERROR: File dibuka dengan file:// protocol!', true);
                        log('ğŸ“ SOLUSI: Gunakan HTTP server!', true);
                        log('   Jalankan: python -m http.server 8000', true);
                        log('   Lalu buka: http://localhost:8000/test-threejs-only.html', true);
                        return;
                    }
                    log('âœ… Protocol OK: ' + window.location.protocol);

                    log('ğŸ”§ Step 2: Loading Three.js from CDN...');
                    const THREE =
                        await import('https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js');
                    log('âœ… Three.js loaded! Version: ' + THREE.REVISION);

                    log('ğŸ”§ Step 3: Creating scene...');
                    const scene = new THREE.Scene();
                    log('âœ… Scene created');

                    log('ğŸ”§ Step 4: Creating camera...');
                    const camera = new THREE.PerspectiveCamera(75, 800 / 400, 0.1, 1000);
                    camera.position.z = 5;
                    log('âœ… Camera created');

                    log('ğŸ”§ Step 5: Creating renderer...');
                    const renderer = new THREE.WebGLRenderer({ antialias: true });
                    renderer.setSize(800, 400);
                    document.getElementById('container').appendChild(renderer.domElement);
                    log('âœ… Renderer created');

                    log('ğŸ”§ Step 6: Creating cube...');
                    const geometry = new THREE.BoxGeometry(1, 1, 1);
                    const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
                    const cube = new THREE.Mesh(geometry, material);
                    scene.add(cube);
                    log('âœ… Cube created');

                    log('ğŸ”§ Step 7: Starting animation...');
                    function animate() {
                        requestAnimationFrame(animate);
                        cube.rotation.x += 0.01;
                        cube.rotation.y += 0.01;
                        renderer.render(scene, camera);
                    }
                    animate();
                    log('âœ… Animation started');

                    log('');
                    log('ğŸ‰ğŸ‰ğŸ‰ SUKSES! THREE.JS BERJALAN DENGAN BAIK! ğŸ‰ğŸ‰ğŸ‰');
                    log('âœ¨ Anda seharusnya melihat kubus hijau berputar di atas');
                    log('');
                    log('ğŸ“ KESIMPULAN: Three.js bekerja dengan baik!');
                    log('   Jika framework masih error, masalahnya ada di kode framework.');
                } catch (error) {
                    log('âŒ ERROR: ' + error.message, true);
                    log('ğŸ“ Stack: ' + error.stack, true);
                    console.error('Full error:', error);

                    log('');
                    log('ğŸ” DIAGNOSTIC INFO:', true);
                    log('  - Protocol: ' + window.location.protocol, true);
                    log('  - Host: ' + window.location.host, true);
                    log('  - Browser: ' + navigator.userAgent, true);
                }
            }

            log('ğŸš€ Starting Three.js test...');
            test();
        </script>
    </body>
</html>
